---
layout: post
title: CLI 프로그램을 만드는데 실패하면서 느낀 점
date: 2018-02-04 15:45:00
tags: 일상글
author: SeonDH

---

<hr />

### CLI 프로그램을 만드는 것을 시도해보았습니다.

* 결론부터 이야기하면, 결과물이 존재하지만 마음에 들지 않습니다.
* 처음에는 http 통신을 통해 메일 서버를 api 서버처럼 만들어서 쉽게 정보를 빼오는 과제라고 생각했습니다. 같은 TF인 덕호님께서 한시간만에 코드를 뚝딱 짜셔서 이번 과제는 쉽게 끝났다고 생각했습니다. 하지만 백창열 이사님께서 그렇게 하는 것이 아니라고 하셔서 새롭게 프로그램을 만드는 것을 시도했습니다. 처음에는 api서버를 통해 접근하는 것이 아니라 service에 바로 접근을 하는 것이 비상식적인 방법이라는 생각이 들었지만, 더 깊게 생각을 해보니 제가 spring 서버를 짜면서 생긴 고정관념은 아닌가 생각하게 되었습니다.
* 처음에는 새롭게 자바 프로그램을 만들어 바로 서비스에 바로 접근을 하려고 했습니다. 이를 위해 자바프로그램을 짜는 것을 시도하는 도중에, 정기님과 희성님이 spring shell에 대해 소개해주었습니다. spring shell은 우리가 spring을 실행할 때 console 창에서 설정된 명령어를 통해 함수를 실행하도록 도와주는 프로젝트입니다. 이 프로젝트를 spring에 maven으로 추가해주는 것 하나만으로 문제의 많은 것이 해결되었습니다. 같은 spring의 함수이므로 서비스에 별다른 설정없이 바로 접근 가능하여 원하는 결과값을 찾아올 수 있었습니다. 아마 다른 TF도 spring shell을 이용한 방법으로 시도하지 않을까 싶습니다. 아래는 window cmd화면에서 서버를 빌드한 후, shell 명령어를 통해 service에 접근하여 DB의 값을 찾아오는 것을 캡쳐해본 것입니다.

![사진](https://raw.githubusercontent.com/SeonDH/SeonDH.github.io/master/_posts/springshell.PNG)

* 하지만 이 것으로 완벽히 문제점이 해결된 것은 아니었습니다. 저희는 linux 서버에 background 환경에서 서버를 띄우므로 콘솔창을 확인 할 수 없다는 문제점이 발생했습니다. 이는 shutdown.sh 명령어를 통해 backgroung tomcat을 종료하고 catalina.sh run 명령어를 통해 foreground에서 실행을 하는 것으로 해결했습니다. linux 환경에서 정상 작동하는 것을 확인 완료하고 과제를 다 했다고 생각하는 순간 다른 문제점을 깨닫게 되었습니다.

* 실제 서버를 운영할 때 서버를 foreground에서 띄운 다는 것은 상식적인 행동이 아니라는 생각이 들었습니다. 단순히 과제를 테스트하기 위한 환경을 만드는 것에 불구하고 실제 서비스 중인 프로젝트의 서비스에 접근 하는 방법에 대해 더 생각을 하게 되었습니다. 그래서 다시 처음으로 돌아와 외부의 java project에서 spring의 service에 접근하는 것에 대해 시도를 해보았습니다. 외부의 java 파일에 spring 프로젝트를 라이브러리처럼 사용하면 해결이 될 것으로 생각했습니다. 그래서 인터넷에서 war file을 import하는 법에 대해 알아보고 spring 프로젝트를 라이브러리처럼 사용하는 java project를 생성하는데 성공했고, 실제 spring내 서비스의 함수를 실행도 해보았습니다. 하지만 문제점은 바로 발생했습니다. spring의 의존성 주입을 생각하지 못 했습니다. \@Autowired라는 명령어를 통해 의존성을 주입해주는 spring의 프로젝트와는 다르게 저의 프로젝트는 각각의 객체를 생성해주어야 했고, 프로그램은 제가 원하는 대로 움직이지 않았습니다. 현재는 외부자바 프로그램에서 spring bean을 사용하는 법에 대해 알아보고 있는 상태입니다. 아직 해결이 되지 않았고 spring을 더 공부하면서 해결이 되는 문제인지 아닌지부터 판별을 해야할 것 같습니다.

* 희성님과 이야기를 하고 새로운 해결책을 찾았습니다.spring shell만을 이용해 db에 접근하는 새로운 spring 프로젝트를 생성하는 방법입니다. 기존의 프로젝트는 back 단에서 띄우며 테스트를 위해서만 띄울 수있는 프로젝트를 아예 생성하는 방법으로 충분히 일리가 있는 말이라 생각했습니다. 하지만 이는 단순 서버를 2개 띄우는 방법으로 우회를 하는 것으로 과제를 위한 과제라고 생각되서 시도하지는 않기로 했습니다. 그리고 백이사님의 '이 과제의 목적은 로직은  service에 두는 것이라는 것을 일깨우기 위한 것이었습니다.' 라는 말을 다시 생각해서 이 정도에서 과제는 마무리하고, spring에 대해 더 깊게 공부하면 나중에 답을 찾기로 하며 마무리해야겠습니다.

* 이 모든 과정을 도와주신 희성님께 특히 감사하고, 처음 spring shell을 알려주신 정기님도 감사합니다. 이 두 분 덕분에 과제를 무사히 끝낼 수 있었던 것 같습니다.

* 마지막으로 개발과 관련 없는 이야기이지만 키보드를 바꿨습니다. 해피해킹으로 코딩을 하니 능률이 50%가 되는 상황을 경험하고 같은 TF에 미안한 마음이 들어서 하나 장만했습니다. 이제 월급이 남은게 없어서 더 열심히 일해야겠습니다.
![사진](https://raw.githubusercontent.com/SeonDH/SeonDH.github.io/master/_posts/realforce.png)






<hr />
